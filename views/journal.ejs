<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Journal</title>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Bootstrap CSS v5.2.1 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous"/>
    <!--font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap" rel="stylesheet" />
    <!-- css stylesheet-->
    <link rel="stylesheet" href="/main.css" />
  </head>
 <!-- Navbar -->
  <body>
    <%-include('navbar') %>
    <!---weekly journal and Mood -->
    <div class="container mt-5">
      <div class="row mb-3">
        <div class="col-12 text-center">
          <h2><strong>Weekly Journal And Mood Tracking</strong></h2>
          <p class="text-muted">A daily practice fo mental clarity and personal growth </p>
        </div>
      </div>
      <div class="row mb-4">
        <div class="col-12 text-center">
              <!---displays full currect date -->
          <p><strong> Todays date: </strong>
            <%= new Date().toLocaleDateString('en-GB', {weekday: 'long', day: 'numeric', month: 'long', year:'numeric'})%></p>
        </div>
      </div>
      <!--Display alert-->
      <% if (typeof alert != 'undefined' && alert.length > 0){ %>
        <% alert.forEach(function(error){ %>
            <div class=" alert alert-warning alert-dismissible fade show" role="alert">
                <%= error.msg %>
                <button
                type="button"
                class="btn-close"
                data-bs-dismiss="alert"
                aria-label="close"
                >
                <span aria-hidden="true">&times;</span>
            </button>
            </div>
       <% }) %>
   <% } %>
       <!---weekly journal and mood drop-down-->
       <div class="accordion" id="journalAccordion">
          <!---loops over each day of the week-->
        <% const daysOfWeek =['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']; %>
        <% daysOfWeek.forEach(day => { %>
        <div class="accordion-item" id="<%= day.toLowerCase() %>">
          <h2 class="accordion-header">
            <button class="accordion-button" data-bs-toggle="collapse" data-bs-target="#collapse<%= day %>">
         <%= day %>  
            </button>
          </h2>
          
         <!--mood drop-down-->
          <div id="collapse<%= day %>" class="accordion-collapse collapse" data-bs-parent="#journalAccordion">
            <div class="accordion-body">
              <form action="/journal/save-mood" method="POST">
               <!---stores day of week when submitting form -->
                <input type="hidden" name="day" value="<%= day%>">
              <label for="<%= day.toLowerCase() %>Mood" class="form-label">Select your mood for today:</label>
              <select class="form-select mood-select"  name="mood" id="<%= day.toLowerCase() %>Mood" required data-day=" <%= day%>" >
                <option value="" disabled selected>Select your mood</option>
                <option value="5">😀 Happy</option>
                <option value="4">🤩 Excited</option>
                <option value="3">😐 Neutral</option>
                <option value="2">😣 Angry</option>
                <option value="1">😥 Sad</option>
              </select>
                <!---save button which submits mood-->
              <button type="submit" class="btn btn-sm mood-button">SAVE</button>
            </form>
              <!---deletes mood-->
            <form action="/journal/delete-mood" method="POST">
              <input type="hidden" name="day" value="<%= day%>">
              <button type = "submit"  class="btn btn-sm mood-button" >DELETE</button>
            </form>
        <!--journal entry-->
              <form action="/journal/save-entry" method="POST">
              <input type="hidden" name="day" value="<%= day%>" >
              <label for="<%= day.toLowerCase() %>Entry" class="form-label">Take a moment to reflect on your day.</label>
              <textarea class="form-control journal-entry" name="entry" rows="4" id="<%= day.toLowerCase() %>Entry" data-day="<%= day%>" > 
              </textarea>
              <button type="submit" class="btn btn-primary save-btn mt-2" data-day="<%= day %>">Save</button>
            </form>
            </div>
          </div>
        </div>
        <% }); %>
      </div>
    </div>
    <!-- Bootstrap JavaScript Libraries -->
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"
      integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
